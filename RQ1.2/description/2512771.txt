Rewrite of lockx in Haskell