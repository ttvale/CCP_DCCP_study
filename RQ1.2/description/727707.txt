Work in progress for eventual contribution to scikit-learn